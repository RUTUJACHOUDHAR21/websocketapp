<script>
  const protocol = window.location.protocol === 'https:' ? 'wss' : 'ws';
  const ws = new WebSocket(`${protocol}://websocketapp-z4wo.onrender.com/ws`);

  const messages = document.getElementById('messages');
  const input = document.getElementById('input');

  // Receive messages from WebSocket server
  ws.onmessage = (event) => {
    const msg = document.createElement('div');
    msg.textContent = event.data;

    // Style as "my-message" or "other-message"
    if (event.data.startsWith("You: ")) {
      msg.className = 'my-message';
    } else {
      msg.className = 'other-message';
    }

    messages.appendChild(msg);
    messages.scrollTop = messages.scrollHeight;
  };

  // Send message to server
  function sendMessage() {
    if (input.value.trim() !== '') {
      const message = 'You: ' + input.value;

      // Show own message instantly
      const myMsg = document.createElement('div');
      myMsg.textContent = message;
      myMsg.className = 'my-message';
      messages.appendChild(myMsg);
      messages.scrollTop = messages.scrollHeight;

      // Send to server
      ws.send(message);

      input.value = '';
    }
  }
</script>
